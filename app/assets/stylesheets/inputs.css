/*
 * Minerva Input Styles
 * Soft & Organic Design System
 * Form input components
 */

@layer components {
  .input {
    /* Configurable properties */
    --input-accent-color: oklch(var(--lch-sage-medium));
    --input-background: oklch(var(--lch-ink-1));
    --input-background-focus: white;
    --input-border-radius: var(--radius-md);
    --input-border-color: oklch(var(--lch-ink-3));
    --input-border-focus: oklch(var(--lch-sage-medium));
    --input-border-size: 1.5px;
    --input-color: var(--color-ink);
    --input-padding: 0.875em 1.125em;

    /* Applied styles */
    accent-color: var(--input-accent-color);
    background-color: var(--input-background);
    border: var(--input-border-size) solid var(--input-border-color);
    border-radius: var(--input-border-radius);
    box-sizing: border-box;
    color: var(--input-color);
    font-family: inherit;
    font-size: max(16px, 1em); /* Prevents iOS zoom */
    inline-size: 100%;
    line-height: var(--line-height-normal);
    padding: var(--input-padding);
    transition: var(--transition-normal);
    transition-property: background-color, border-color, box-shadow;
  }

  .input:hover:not(:focus) {
    --input-border-color: oklch(var(--lch-ink-4));
  }

  .input:focus {
    background-color: var(--input-background-focus);
    border-color: var(--input-border-focus);
    box-shadow: var(--glow-sage);
    outline: none;
  }

  .input::placeholder {
    color: oklch(var(--lch-ink-4));
  }

  .input:disabled {
    cursor: not-allowed;
    opacity: 0.5;
    pointer-events: none;
  }

  .input[readonly] {
    background-color: oklch(var(--lch-ink-2));
  }

  .input[readonly]:focus {
    box-shadow: none;
  }

  /* Textarea */
  textarea.input {
    min-block-size: 140px;
    resize: vertical;
  }

  /* Auto-resize textarea (modern browsers) */
  @supports (field-sizing: content) {
    .input--auto-resize {
      field-sizing: content;
      max-block-size: 50vh;
      min-block-size: calc(3lh + (2 * 0.875em));
    }
  }

  /* Select dropdown */
  .input--select {
    --input-border-radius: var(--radius-full);
    --input-padding: 0.625em 2.25em 0.625em 1.25em;
    appearance: none;
    background-image: url("caret-down.svg");
    background-position: right 0.75em center;
    background-repeat: no-repeat;
    background-size: 1em;
    cursor: pointer;
  }

  /* File input wrapper */
  .input--file {
    cursor: pointer;
    display: grid;
    place-items: center;
    position: relative;
  }

  .input--file input[type="file"] {
    cursor: pointer;
    font-size: 0;
    inset: 0;
    opacity: 0;
    position: absolute;
  }

  /* Autofill styling */
  .input:autofill,
  .input:-webkit-autofill {
    -webkit-box-shadow: 0 0 0px 1000px oklch(var(--lch-sage-lightest)) inset;
    -webkit-text-fill-color: var(--color-ink);
  }

  /* Switch/Toggle - More organic pill shape */
  .switch {
    block-size: 1.875em;
    border-radius: var(--radius-full);
    cursor: pointer;
    display: inline-block;
    inline-size: 3.25em;
    position: relative;
  }

  .switch__input {
    block-size: 1px;
    clip: rect(0 0 0 0);
    inline-size: 1px;
    overflow: hidden;
    position: absolute;
    white-space: nowrap;
  }

  .switch__btn {
    --switch-off: oklch(var(--lch-ink-4));
    --switch-on: oklch(var(--lch-sage-medium));
    background-color: var(--switch-off);
    block-size: 100%;
    border-radius: inherit;
    display: block;
    inline-size: 100%;
    transition: background-color 250ms var(--ease-out-expo);
  }

  .switch__btn::before {
    background-color: white;
    block-size: 1.5em;
    border-radius: 50%;
    box-shadow: var(--shadow-xs);
    content: "";
    display: block;
    inline-size: 1.5em;
    position: relative;
    inset-block-start: 0.1875em;
    inset-inline-start: 0.1875em;
    transition: transform 250ms var(--ease-out-overshoot);
  }

  .switch__input:checked + .switch__btn {
    background-color: var(--switch-on);
  }

  .switch__input:checked + .switch__btn::before {
    transform: translateX(1.375em);
  }

  .switch__input:focus-visible + .switch__btn {
    box-shadow: var(--glow-sage);
  }

  .switch__input:disabled + .switch__btn {
    cursor: not-allowed;
    opacity: 0.5;
  }

  /* Checkbox and Radio as buttons */
  .btn:has(input[type="radio"]),
  .btn:has(input[type="checkbox"]) {
    position: relative;
  }

  .btn:has(input[type="radio"]) input,
  .btn:has(input[type="checkbox"]) input {
    appearance: none;
    cursor: pointer;
    inset: 0;
    position: absolute;
  }

  .btn:has(input[type="radio"]:checked),
  .btn:has(input[type="checkbox"]:checked) {
    --btn-background: oklch(var(--lch-sage-medium));
    --btn-border-color: oklch(var(--lch-sage-medium));
    --btn-color: white;
  }

  /* Input group with icon */
  .input-group {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    position: relative;
  }

  .input-group .icon {
    color: oklch(var(--lch-ink-4));
    flex-shrink: 0;
  }

  .input-group .input {
    flex: 1;
  }

  .input-group--icon-start {
    .input {
      padding-inline-start: 2.75em;
    }

    .icon {
      position: absolute;
      inset-inline-start: 1em;
      pointer-events: none;
    }
  }
}
